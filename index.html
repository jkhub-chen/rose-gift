<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‡´æˆ‘æœ€çˆ±çš„å°ä»™å¥³å¼ æ¢¦å©· ğŸ’•</title>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-pink: #ff4081;
            --deep-pink: #e91e63;
            --light-pink: #ffe4f0;
            --soft-pink: #ffc1e3;
            --glow-pink: rgba(255, 105, 180, 0.5);
            --glass-bg: rgba(255, 255, 255, 0.55);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* åŠ è½½å±å¹• */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #fef7f7 0%, #fce4ec 50%, #f8bbd9 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-heart {
            font-size: 72px;
            animation: heartbeat 0.8s ease-in-out infinite;
            filter: drop-shadow(0 0 30px rgba(255, 105, 180, 0.8));
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.15); }
            50% { transform: scale(1.25); }
            75% { transform: scale(1.15); }
        }

        .loading-text {
            margin-top: 20px;
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 1.4rem;
            color: var(--deep-pink);
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        body {
            min-height: 100vh;
            min-height: 100dvh;
            background: linear-gradient(135deg, #fff5f8 0%, #ffe4f0 30%, #ffc1e3 70%, #ffb8d8 100%);
            overflow-x: hidden;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            position: relative;
            animation: bgShift 15s ease-in-out infinite;
        }

        @keyframes bgShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* åŠ¨æ€èƒŒæ™¯å…‰æ™• */
        .bg-glow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .glow-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(100px);
            opacity: 0.6;
            animation: floatOrb 15s ease-in-out infinite;
        }

        .glow-orb:nth-child(1) {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(255,182,220,0.7) 0%, rgba(255,182,220,0.3) 50%, transparent 70%);
            top: -150px;
            left: -150px;
            animation-delay: 0s;
        }

        .glow-orb:nth-child(2) {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(255,133,200,0.6) 0%, rgba(255,133,200,0.2) 50%, transparent 70%);
            bottom: -100px;
            right: -100px;
            animation-delay: -5s;
        }

        .glow-orb:nth-child(3) {
            width: 350px;
            height: 350px;
            background: radial-gradient(circle, rgba(255,220,240,0.8) 0%, rgba(255,220,240,0.3) 50%, transparent 70%);
            top: 40%;
            left: 60%;
            animation-delay: -10s;
        }

        @keyframes floatOrb {
            0%, 100% { transform: translate(0, 0) scale(1) rotate(0deg); }
            25% { transform: translate(40px, -30px) scale(1.15) rotate(5deg); }
            50% { transform: translate(-20px, 40px) scale(0.95) rotate(-3deg); }
            75% { transform: translate(30px, 20px) scale(1.05) rotate(2deg); }
        }

        .garden {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 2;
        }

        .flower-img {
            position: absolute;
            will-change: transform, opacity;
            animation: bloom 1.2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            transition: transform 0.3s ease, opacity 0.5s ease;
        }

        .flower-img:hover {
            transform: scale(1.1) !important;
            z-index: 10;
        }

        .flower-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            filter: saturate(1.25) contrast(1.08) brightness(1.05);
            box-shadow: 
                0 4px 20px rgba(255, 133, 200, 0.5),
                0 8px 40px rgba(255, 105, 180, 0.35),
                0 0 50px rgba(255, 182, 220, 0.3);
            animation: gentleSway 5s ease-in-out infinite, softPulse 4s ease-in-out infinite;
            border: 2px solid rgba(255, 255, 255, 0.4);
            transition: all 0.4s ease;
        }

        .flower-img:hover img {
            filter: saturate(1.4) contrast(1.15) brightness(1.1);
            box-shadow: 
                0 8px 35px rgba(255, 133, 200, 0.9),
                0 15px 60px rgba(255, 105, 180, 0.6),
                0 0 80px rgba(255, 182, 220, 0.5),
                inset 0 0 50px rgba(255, 255, 255, 0.5);
            transform: scale(1.08);
        }

        @keyframes bloom {
            0% { 
                opacity: 0; 
                transform: scale(0) rotate(-60deg); 
                filter: blur(20px) brightness(1.3);
            }
            40% { 
                opacity: 0.6; 
                transform: scale(1.15) rotate(8deg); 
                filter: blur(5px) brightness(1.15);
            }
            70% {
                opacity: 0.9;
                transform: scale(0.95) rotate(-3deg);
                filter: blur(1px) brightness(1.05);
            }
            100% { 
                opacity: 1; 
                transform: scale(1) rotate(0deg); 
                filter: blur(0) saturate(1.25) contrast(1.08) brightness(1.05);
            }
        }

        @keyframes gentleSway {
            0%, 100% { transform: translateY(0) rotate(-3deg) scale(1); }
            20% { transform: translateY(-8px) rotate(2deg) scale(1.03); }
            40% { transform: translateY(-5px) rotate(4deg) scale(1); }
            60% { transform: translateY(-10px) rotate(1deg) scale(1.02); }
            80% { transform: translateY(-4px) rotate(-2deg) scale(1.01); }
        }

        @keyframes softPulse {
            0%, 100% { 
                box-shadow: 
                    0 6px 25px rgba(255, 133, 200, 0.7),
                    0 12px 50px rgba(255, 105, 180, 0.5),
                    0 0 60px rgba(255, 182, 220, 0.4),
                    inset 0 0 40px rgba(255, 255, 255, 0.4);
            }
            50% { 
                box-shadow: 
                    0 8px 30px rgba(255, 133, 200, 0.8),
                    0 15px 60px rgba(255, 105, 180, 0.6),
                    0 0 80px rgba(255, 182, 220, 0.5),
                    inset 0 0 50px rgba(255, 255, 255, 0.5);
            }
        }

        /* é£˜è½èŠ±ç“£ - æ›´è‡ªç„¶ */
        .petal {
            position: fixed;
            pointer-events: none;
            z-index: 50;
            animation: petalFall linear forwards;
            filter: drop-shadow(0 2px 6px rgba(255, 105, 180, 0.3));
        }

        @keyframes petalFall {
            0% {
                transform: translateY(-10vh) rotate(0deg) translateX(0) scale(1);
                opacity: 0.95;
                filter: blur(0px);
            }
            25% {
                transform: translateY(25vh) rotate(180deg) translateX(40px) scale(0.95);
                filter: blur(0.5px);
            }
            50% {
                transform: translateY(50vh) rotate(360deg) translateX(-30px) scale(0.9);
                filter: blur(1px);
            }
            75% {
                transform: translateY(75vh) rotate(540deg) translateX(50px) scale(0.85);
                filter: blur(1.5px);
            }
            100% {
                transform: translateY(110vh) rotate(720deg) translateX(30px) scale(0.8);
                opacity: 0.15;
                filter: blur(2px);
            }
        }

        /* é—ªçƒæ˜Ÿæ˜Ÿ - æ›´æŸ”å’Œ */
        .sparkle {
            position: fixed;
            pointer-events: none;
            z-index: 60;
            animation: sparkleAnim 2.5s ease-in-out forwards;
            filter: drop-shadow(0 0 15px rgba(255, 182, 220, 0.9));
        }

        @keyframes sparkleAnim {
            0% { 
                opacity: 0; 
                transform: scale(0) rotate(0deg); 
                filter: blur(2px);
            }
            25% { 
                opacity: 1; 
                transform: scale(1.3) rotate(90deg); 
                filter: blur(0px);
            }
            50% { 
                opacity: 0.9; 
                transform: scale(1) rotate(180deg); 
            }
            75% {
                opacity: 0.6;
                transform: scale(0.8) rotate(270deg);
            }
            100% { 
                opacity: 0; 
                transform: scale(0) rotate(360deg); 
                filter: blur(2px);
            }
        }

        .leaf {
            position: absolute;
            will-change: transform, opacity;
            animation: leafIn 0.8s ease forwards;
            opacity: 0.85;
            filter: drop-shadow(0 2px 6px rgba(255, 133, 200, 0.25));
        }

        @keyframes leafIn {
            0% { opacity: 0; transform: scale(0) rotate(-45deg) translateY(30px); }
            100% { opacity: 0.85; transform: scale(1) rotate(var(--rot)) translateY(0); }
        }

        .star {
            position: absolute;
            will-change: transform, opacity;
            animation: starIn 0.8s ease forwards;
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8));
        }

        @keyframes starIn {
            0% { opacity: 0; transform: scale(0) rotate(-180deg); filter: blur(4px); }
            100% { opacity: 1; transform: scale(1) rotate(0deg); filter: blur(0); }
        }

        /* å¡ç‰‡ - å‡çº§æ¯›ç»ç’ƒæ•ˆæœ */
        .card {
            position: fixed;
            top: 52%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.3) 0%, rgba(255, 240, 248, 0.4) 100%);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            border-radius: 22px;
            padding: 30px 25px;
            box-shadow: 
                0 4px 25px rgba(255, 105, 180, 0.12),
                0 0 50px rgba(255, 182, 220, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                inset 0 -1px 0 rgba(255, 182, 220, 0.15);
            text-align: center;
            z-index: 100;
            max-width: 82%;
            width: 360px;
            opacity: 0;
            animation: cardIn 1.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            animation-delay: 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.5);
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .card:hover {
            transform: translate(-50%, -50%) scale(1.02);
            box-shadow: 
                0 10px 40px rgba(255, 105, 180, 0.25),
                0 0 80px rgba(255, 182, 220, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.8),
                inset 0 -1px 0 rgba(255, 182, 220, 0.3);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.45) 0%, rgba(255, 240, 248, 0.55) 100%);
        }

        @keyframes cardIn {
            0% { 
                opacity: 0; 
                transform: translate(-50%, -40%) scale(0.8) rotateX(15deg); 
                filter: blur(10px);
            }
            50% {
                opacity: 0.8;
                transform: translate(-50%, -52%) scale(1.02) rotateX(-2deg);
            }
            100% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1) rotateX(0deg); 
                filter: blur(0);
            }
        }

        .card-title {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 1.35rem;
            color: #d81b60;
            margin-bottom: 15px;
            text-shadow: 0 2px 15px rgba(255, 105, 180, 0.3);
            letter-spacing: 2px;
            animation: titleFloat 3s ease-in-out infinite;
        }

        @keyframes titleFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
        }

        .card-title .name {
            color: var(--primary-pink);
            font-size: 1.85rem;
            display: inline-block;
            background: linear-gradient(135deg, #ff4081 0%, #ff80ab 30%, #ff4081 60%, #f50057 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 300% 300%;
            animation: gradientShift 3s ease infinite, nameGlow 2s ease-in-out infinite;
            filter: drop-shadow(0 0 12px rgba(255, 105, 180, 0.4));
        }

        @keyframes nameGlow {
            0%, 100% { 
                filter: drop-shadow(0 0 8px rgba(255, 105, 180, 0.4)) drop-shadow(0 0 15px rgba(255, 133, 200, 0.2));
                transform: scale(1);
            }
            50% { 
                filter: drop-shadow(0 0 15px rgba(255, 105, 180, 0.7)) drop-shadow(0 0 30px rgba(255, 133, 200, 0.4));
                transform: scale(1.05);
            }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .card-text {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 1.1rem;
            color: #ad1457;
            line-height: 1.7;
            min-height: 35px;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
            letter-spacing: 0.5px;
        }

        .cursor {
            display: inline-block;
            width: 2px;
            height: 1.3rem;
            background: linear-gradient(180deg, var(--primary-pink) 0%, #ff4081 100%);
            vertical-align: middle;
            animation: blink 0.8s infinite;
            border-radius: 1px;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .card-signature {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 0.95rem;
            color: #c2185b;
            text-align: right;
            margin-top: 15px;
            opacity: 0.95;
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.6);
        }

        .card-hearts {
            margin-top: 15px;
            font-size: 1.3rem;
            animation: heartsFloat 2s ease-in-out infinite;
            filter: drop-shadow(0 2px 4px rgba(255, 105, 180, 0.3));
        }

        @keyframes heartsFloat {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-4px) scale(1.1); }
        }

        .hint {
            position: fixed;
            bottom: 35px;
            left: 50%;
            transform: translateX(-50%);
            color: #d81b60;
            font-size: 0.95rem;
            opacity: 0;
            animation: fadeIn 1s ease forwards;
            animation-delay: 2.5s;
            z-index: 99;
            font-family: 'Ma Shan Zheng', cursive;
            background: rgba(255, 255, 255, 0.5);
            padding: 10px 20px;
            border-radius: 25px;
            backdrop-filter: blur(15px);
            box-shadow: 0 4px 20px rgba(255, 105, 180, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }

        @keyframes fadeIn {
            to { opacity: 0.9; }
        }

        .heart-pop {
            position: fixed;
            pointer-events: none;
            z-index: 200;
            font-size: 28px;
            animation: popUp 2.5s ease-out forwards;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }

        @keyframes popUp {
            0% { 
                opacity: 1; 
                transform: translateY(0) scale(0.5) rotate(0deg); 
            }
            20% {
                opacity: 1;
                transform: translateY(-30px) scale(1.2) rotate(10deg);
            }
            100% { 
                opacity: 0; 
                transform: translateY(-150px) scale(0.3) rotate(30deg); 
            }
        }

        /* çˆ±å¿ƒç²’å­æ•ˆæœ */
        .love-particle {
            position: fixed;
            pointer-events: none;
            z-index: 150;
            animation: particleFloat 3s ease-out forwards;
        }

        @keyframes particleFloat {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0.2) rotate(360deg);
            }
        }

        /* å“åº”å¼ä¼˜åŒ– */
        @media (max-width: 480px) {
            .card { 
                padding: 30px 25px; 
                width: 92%;
                border-radius: 20px;
            }
            .card-title { font-size: 1.3rem; }
            .card-title .name { font-size: 1.7rem; }
            .card-text { font-size: 1rem; }
            .loading-heart { font-size: 56px; }
            .loading-text { font-size: 1.2rem; }
        }

        @media (max-width: 360px) {
            .card { padding: 24px 20px; }
            .card-title { font-size: 1.15rem; }
            .card-title .name { font-size: 1.5rem; }
            .card-text { font-size: 0.95rem; }
        }

        /* å‡å°‘åŠ¨ç”»åå¥½ */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- åŠ è½½å±å¹• -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-heart">ğŸ’•</div>
        <div class="loading-text">æ­£åœ¨ä¸ºä½ å‡†å¤‡æƒŠå–œ...</div>
    </div>

    <!-- èƒŒæ™¯å…‰æ™• -->
    <div class="bg-glow">
        <div class="glow-orb"></div>
        <div class="glow-orb"></div>
        <div class="glow-orb"></div>
    </div>

    <div class="garden" id="garden"></div>

    <div class="card">
        <h1 class="card-title">è‡´æˆ‘æœ€çˆ±çš„ <span class="name">å¼ æ¢¦å©·</span></h1>
        <p class="card-text"><span id="text"></span><span class="cursor"></span></p>
        <p class="card-signature">â€”â€” æ°¸è¿œçˆ±ä½ çš„ å¤§å®è´ ğŸ’</p>
        <div class="card-hearts">ğŸ’• ğŸ’— ğŸ’•</div>
    </div>

    <p class="hint">ğŸ‘† ç‚¹å‡»å±å¹•é‡Šæ”¾çˆ±æ„</p>

    <script>
        // æ ¹æ®å±å¹•å°ºå¯¸é€‰æ‹©åˆé€‚çš„å›¾ç‰‡å°ºå¯¸
        function getImageSize() {
            const width = window.innerWidth;
            if (width <= 480) return 400; // æ‰‹æœºç”¨400pxä¿è¯æ¸…æ™°åº¦
            if (width <= 768) return 500; // å¹³æ¿ç”¨ä¸­å›¾
            return 600; // æ¡Œé¢ç”¨å¤§å›¾
        }

        // å”¯ç¾èŠ±æœµå’Œé£æ™¯å›¾ç‰‡ - é€‚é…ç§»åŠ¨ç«¯
        const roseImages = [
            // ç²‰è‰²ç«ç‘°
            'https://images.unsplash.com/photo-1562690868-60bbe7293e94',
            'https://images.unsplash.com/photo-1496857239036-1fb137683000',
            'https://images.unsplash.com/photo-1548586196-aa5803b77379',
            'https://images.unsplash.com/photo-1559563362-c667ba5f5480',
            // çº¢ç«ç‘°
            'https://images.unsplash.com/photo-1548765015-1e047ff434e2',
            'https://images.unsplash.com/photo-1559563458-527698bf5295',
            'https://images.unsplash.com/photo-1494972308805-463bc619d34e',
            // ç™½ç«ç‘°
            'https://images.unsplash.com/photo-1555448248-2571daf6344b',
            'https://images.unsplash.com/photo-1518709766631-a6a7f45921c3',
            // æ¨±èŠ±
            'https://images.unsplash.com/photo-1522383225653-ed111181a951',
            'https://images.unsplash.com/photo-1490750967868-88aa4486c946',
            // ç‰¡ä¸¹/èŠè¯
            'https://images.unsplash.com/photo-1563241527-3004b7be0ffd',
        ];

        // å¤‡ç”¨å›¾ç‰‡æº
        const fallbackRoseImages = [
            'https://images.unsplash.com/photo-1468327768560-75b778cbb551',
            'https://images.unsplash.com/photo-1455659817273-f96807779a8a',
            'https://images.unsplash.com/photo-1508610048659-a06b669e3321',
        ];

        // é£æ™¯å’Œå…¶ä»–èŠ±æœµå›¾ç‰‡
        const flowerImages = [
            'https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05',
            'https://images.unsplash.com/photo-1441974231531-c6227db76b6e',
            'https://images.unsplash.com/photo-1501854140801-50d01698950b',
            'https://images.unsplash.com/photo-1472214103451-9374bd1c798e',
            'https://images.unsplash.com/photo-1468327768560-75b778cbb551',
            'https://images.unsplash.com/photo-1498579687545-d5a4fffb0ac9',
            'https://images.unsplash.com/photo-1470509037663-253afd7f0f51',
            'https://images.unsplash.com/photo-1520763185298-1b434c919102',
            'https://images.unsplash.com/photo-1465146344425-f00d5f5c8f07',
            'https://images.unsplash.com/photo-1506905925346-21bda4d32df4',
        ];

        // è¿½è¸ªå¤±è´¥çš„å›¾ç‰‡
        let failedImages = new Set();

        // åˆ›å»ºèŠ±æœµ - è¿”å› Promise ä»¥ä¾¿è·Ÿè¸ªåŠ è½½çŠ¶æ€
        function createFlower(x, y, size, delay, isRose = true) {
            return new Promise((resolve) => {
                const flower = document.createElement('div');
                flower.className = 'flower-img';
                flower.style.left = x + 'px';
                flower.style.top = y + 'px';
                flower.style.width = size + 'px';
                flower.style.height = size + 'px';
                flower.style.animationDelay = delay + 's';
                flower.style.opacity = '0'; // åˆå§‹éšè—ï¼ŒåŠ è½½å®Œæˆå†æ˜¾ç¤º

                const images = isRose ? roseImages : flowerImages;
                const fallbacks = isRose ? fallbackRoseImages : [];
                const baseSrc = images[Math.floor(Math.random() * images.length)];
                // æ ¹æ®å±å¹•å°ºå¯¸æ·»åŠ åˆé€‚çš„å›¾ç‰‡å°ºå¯¸å‚æ•°
                const imgSize = getImageSize();
                const imgSrc = `${baseSrc}?w=${imgSize}&q=80&fit=crop`;

                const img = document.createElement('img');
                img.src = imgSrc;
                img.alt = 'flower';
                img.loading = 'eager'; // ç«‹å³åŠ è½½

                // å›¾ç‰‡åŠ è½½æˆåŠŸ
                img.onload = function() {
                    flower.style.opacity = '1';
                    resolve(flower);
                };

                // å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶å°è¯•å¤‡ç”¨å›¾ç‰‡
                img.onerror = function() {
                    if (failedImages.has(baseSrc)) {
                        flower.remove();
                        resolve(null);
                        return;
                    }
                    failedImages.add(baseSrc);

                    // å°è¯•å¤‡ç”¨å›¾ç‰‡
                    if (fallbacks.length > 0) {
                        const fallbackBase = fallbacks[Math.floor(Math.random() * fallbacks.length)];
                        if (!failedImages.has(fallbackBase)) {
                            img.src = `${fallbackBase}?w=${imgSize}&q=80&fit=crop`;
                            return;
                        }
                    }
                    flower.remove();
                    resolve(null);
                };

                // è¶…æ—¶å¤„ç† - 3ç§’åå¼ºåˆ¶å®Œæˆ
                setTimeout(() => {
                    if (flower.parentNode) {
                        flower.style.opacity = '1';
                    }
                    resolve(flower);
                }, 3000);

                flower.appendChild(img);
            });
        }

        // åˆ›å»ºå¶å­ - ç²‰è‰²ç³»
        function createLeaf(x, y, size, delay) {
            const leaf = document.createElement('div');
            leaf.className = 'leaf';
            leaf.style.left = x + 'px';
            leaf.style.top = y + 'px';
            leaf.style.setProperty('--rot', (Math.random() * 360) + 'deg');
            leaf.style.animationDelay = delay + 's';

            const pinkGreens = ['#f8bbd0', '#f48fb1', '#f06292', '#e91e63'];
            const color1 = pinkGreens[Math.floor(Math.random() * pinkGreens.length)];
            const color2 = pinkGreens[Math.floor(Math.random() * pinkGreens.length)];
            const gradientId = 'lg' + Math.random().toString(36).substr(2, 9);

            leaf.innerHTML = `
                <svg viewBox="0 0 40 20" width="${size}" height="${size * 0.5}">
                    <defs>
                        <linearGradient id="${gradientId}" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:${color1}"/>
                            <stop offset="100%" style="stop-color:${color2}"/>
                        </linearGradient>
                    </defs>
                    <path d="M3 10 Q15 0 37 10 Q15 20 3 10" fill="url(#${gradientId})" opacity="0.85"/>
                    <path d="M3 10 L37 10" stroke="#f48fb1" stroke-width="0.5" fill="none" opacity="0.4"/>
                </svg>
            `;

            return leaf;
        }

        // åˆ›å»ºæ»¡å¤©æ˜Ÿ
        function createStars(x, y, size, delay) {
            const container = document.createElement('div');
            container.className = 'star';
            container.style.left = x + 'px';
            container.style.top = y + 'px';
            container.style.width = size + 'px';
            container.style.height = size + 'px';
            container.style.animationDelay = delay + 's';

            const dotCount = 4 + Math.floor(Math.random() * 4);
            const pinkColors = ['#fff0f5', '#ffe4f0', '#ffc1e3', '#ffb8d8'];
            for (let i = 0; i < dotCount; i++) {
                const dot = document.createElement('div');
                const dotSize = 5 + Math.random() * 5;
                const color = pinkColors[Math.floor(Math.random() * pinkColors.length)];
                dot.style.cssText = `
                    position: absolute;
                    width: ${dotSize}px;
                    height: ${dotSize}px;
                    border-radius: 50%;
                    background: radial-gradient(circle, ${color} 0%, rgba(255,255,255,0.8) 100%);
                    box-shadow: 0 0 12px rgba(255,182,220,0.9), 0 0 20px rgba(255,105,180,0.4);
                    left: ${Math.random() * size}px;
                    top: ${Math.random() * size}px;
                `;
                container.appendChild(dot);
            }

            return container;
        }

        // åˆå§‹åŒ–èŠ±å›­ - è¿”å› Promise ç­‰å¾…æ‰€æœ‰å›¾ç‰‡åŠ è½½
        async function initGarden() {
            const garden = document.getElementById('garden');
            const w = window.innerWidth;
            const h = window.innerHeight;
            const isMobile = w <= 480;

            const positions = [];
            const flowerPromises = [];

            // ä¸Šä¸‹å¸ƒå±€ï¼šä¸Šé¢1-2å¼ ï¼Œä¸‹é¢1-2å¼ ï¼Œæ€»å…±2-4å¼ 
            const topCount = isMobile ? (Math.random() > 0.5 ? 1 : 2) : 2;
            const bottomCount = isMobile ? (Math.random() > 0.5 ? 1 : 2) : 2;
            
            // è®¡ç®—å¡ç‰‡åŒºåŸŸï¼ˆä¸­é—´ç•™ç™½ç»™æ–‡æ¡ˆï¼‰
            const cardTop = h * 0.35;
            const cardBottom = h * 0.65;

            // æ”¾ç½®é¡¶éƒ¨èŠ±æœµ
            for (let i = 0; i < topCount; i++) {
                // å¤§å°ä¸ä¸€ï¼šå°å›¾åˆ°ä¸­ç­‰å›¾
                const size = isMobile ? (w * 0.28 + Math.random() * w * 0.15) : (100 + Math.random() * 60);
                // é¡¶éƒ¨åŒºåŸŸéšæœºä½ç½®
                const x = size/2 + Math.random() * (w - size);
                const y = size/2 + Math.random() * (cardTop - size);
                
                positions.push({ x, y, size });
                flowerPromises.push(
                    createFlower(x - size/2, y - size/2, size, i * 0.15, true).then(flower => {
                        if (flower) garden.appendChild(flower);
                    })
                );
            }

            // æ”¾ç½®åº•éƒ¨èŠ±æœµ
            for (let i = 0; i < bottomCount; i++) {
                const size = isMobile ? (w * 0.28 + Math.random() * w * 0.15) : (100 + Math.random() * 60);
                const x = size/2 + Math.random() * (w - size);
                const y = cardBottom + Math.random() * (h - cardBottom - size/2);
                
                positions.push({ x, y, size });
                flowerPromises.push(
                    createFlower(x - size/2, y - size/2, size, 0.3 + i * 0.15, true).then(flower => {
                        if (flower) garden.appendChild(flower);
                    })
                );
            }

            // ç­‰å¾…æ‰€æœ‰èŠ±æœµå›¾ç‰‡åŠ è½½å®Œæˆ
            await Promise.all(flowerPromises);

            // æ”¾ç½®æ»¡å¤©æ˜Ÿ - æ ¹æ®èŠ±æœµæ•°é‡
            const totalFlowers = topCount + bottomCount;
            for (let i = 0; i < totalFlowers; i++) {
                let x = 30 + Math.random() * (w - 60);
                let y = 30 + Math.random() * (h - 60);
                const size = 30 + Math.random() * 20;
                garden.appendChild(createStars(x, y, size, Math.random() * 0.5));
            }

            // æ”¾ç½®å¶å­
            for (let i = 0; i < totalFlowers; i++) {
                let x = 20 + Math.random() * (w - 40);
                let y = 20 + Math.random() * (h - 40);
                const size = 25 + Math.random() * 20;
                garden.appendChild(createLeaf(x, y, size, Math.random() * 0.4));
            }
        }

        // æ‰“å­—æœº
        const messages = [
            "å¼ æ¢¦å©·ï¼Œé‡è§ä½ æ˜¯æˆ‘è¿™è¾ˆå­æœ€å¤§çš„å¹¸è¿ ğŸ’•",
            "æ¯ä¸€ç§’æƒ³ä½ ï¼Œå¿ƒè·³éƒ½ä¼šåŠ é€Ÿ âœ¨",
            "ä½ çš„ç¬‘å®¹ï¼Œæ˜¯æˆ‘è§è¿‡æœ€ç¾çš„é£æ™¯ ğŸŒ¸",
            "æƒ³ç‰µç€ä½ çš„æ‰‹ï¼Œèµ°å®Œä½™ç”Ÿçš„æ¯ä¸€å¤© ğŸŒ¹",
            "ä½ æ˜¯æˆ‘å¿ƒä¸­å”¯ä¸€çš„å¥³ç¥ï¼Œæ°¸è¿œçš„å®è´ ğŸ’—",
            "æ¢¦å©·ï¼Œæˆ‘å¥½æƒ³ä½ ï¼Œæƒ³è§ä½ ï¼Œæƒ³æŠ±ä½  ğŸ’‹",
            "æˆ‘çš„ä¸–ç•Œå› ä½ è€Œå®Œæ•´ï¼Œçˆ±ä½ åˆ°æ°¸è¿œ ğŸ’–",
            "æ„¿æ„ä¸ºä½ åšä»»ä½•äº‹ï¼Œåªæƒ³çœ‹ä½ å¼€å¿ƒ ğŸ˜˜",
            "ä½ æ˜¯æˆ‘çš„å…¨éƒ¨ï¼Œæˆ‘çš„å…¨ä¸–ç•Œéƒ½æ˜¯ä½  ğŸŒ™",
            "è¿™ä¸€ç”Ÿæˆ‘åªçˆ±ä½ ä¸€ä¸ªï¼Œå¼ æ¢¦å©· â¤ï¸",
            "æ¯æ¬¡çœ‹åˆ°ä½ ï¼Œæˆ‘çš„å¿ƒéƒ½èåŒ–äº† ğŸ’•",
            "æƒ³å’Œä½ ä¸€èµ·é†’æ¥ï¼Œä¸€èµ·å…¥ç¡ï¼Œç›´åˆ°ç™½å¤´ ğŸ¥°",
            "ä½ æ˜¯æˆ‘ä»Šç”Ÿå”¯ä¸€çš„æ‰§ç€ï¼Œå”¯ä¸€çš„ç‰µæŒ‚ ğŸ’",
            "æ¢¦å©·å®è´ï¼Œä½ æ˜¯æˆ‘çš„å¿ƒè‚å°ç”œèœœ ğŸ¬",
            "çˆ±ä½ å…¥éª¨ï¼Œæ­¤ç”Ÿä¸æ¸ï¼Œæ°¸è¿œåªçˆ±ä½  ğŸ”¥"
        ];

        let mi = 0, ci = 0, del = false;
        const textEl = document.getElementById('text');

        function type() {
            const msg = messages[mi];
            if (!del) {
                textEl.textContent = msg.substring(0, ++ci);
                if (ci >= msg.length) { del = true; setTimeout(type, 2000); return; }
            } else {
                textEl.textContent = msg.substring(0, --ci);
                if (ci <= 0) { del = false; mi = (mi + 1) % messages.length; }
            }
            setTimeout(type, del ? 30 : 70);
        }

        // é¼ æ ‡/è§¦æ‘¸ä½ç½®è¿½è¸ª
        let mouseX = 0, mouseY = 0;
        document.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });

        // è§†å·®æ•ˆæœ
        let ticking = false;
        function updateParallax() {
            const flowers = document.querySelectorAll('.flower-img');
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            
            flowers.forEach((flower, index) => {
                const speed = 0.02 + (index % 3) * 0.01;
                const offsetX = (mouseX - centerX) * speed;
                const offsetY = (mouseY - centerY) * speed;
                flower.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
            });
            ticking = false;
        }

        document.addEventListener('mousemove', () => {
            if (!ticking) {
                requestAnimationFrame(updateParallax);
                ticking = true;
            }
        });

        // ç‚¹å‡»æ•ˆæœ - å‡çº§çˆ±å¿ƒç²’å­
        function popHearts(x, y) {
            const hearts = ['ğŸ’—', 'ğŸ’•', 'ğŸ’–', 'â¤ï¸', 'ğŸŒ¹', 'ğŸŒ¸', 'âœ¨', 'ğŸ’«', 'ğŸ’', 'ğŸ’˜'];
            const colors = ['#ff1744', '#e91e63', '#ff4081', '#f50057', '#c2185b'];
            
            // ä¸»çˆ±å¿ƒ
            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    const h = document.createElement('div');
                    h.className = 'heart-pop';
                    h.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                    h.style.left = (x + (Math.random() - 0.5) * 120) + 'px';
                    h.style.top = y + 'px';
                    h.style.fontSize = (22 + Math.random() * 20) + 'px';
                    h.style.filter = `drop-shadow(0 0 10px ${colors[Math.floor(Math.random() * colors.length)]})`;
                    document.body.appendChild(h);
                    setTimeout(() => h.remove(), 2500);
                }, i * 50);
            }

            // ç²’å­æ•ˆæœ
            for (let i = 0; i < 12; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'love-particle';
                    particle.textContent = ['âœ¦', 'âœ§', 'â‹†', 'â€¢', 'Â·'][Math.floor(Math.random() * 5)];
                    particle.style.left = x + 'px';
                    particle.style.top = y + 'px';
                    particle.style.fontSize = (8 + Math.random() * 12) + 'px';
                    particle.style.color = colors[Math.floor(Math.random() * colors.length)];
                    particle.style.setProperty('--tx', (Math.random() - 0.5) * 200 + 'px');
                    particle.style.setProperty('--ty', (Math.random() - 0.5) * 200 - 100 + 'px');
                    document.body.appendChild(particle);
                    setTimeout(() => particle.remove(), 3000);
                }, i * 40);
            }

            // åˆ›å»ºæ¶Ÿæ¼ªæ•ˆæœ
            createRipple(x, y);
        }

        // æ¶Ÿæ¼ªæ•ˆæœ
        function createRipple(x, y) {
            const ripple = document.createElement('div');
            ripple.style.cssText = `
                position: fixed;
                left: ${x}px;
                top: ${y}px;
                width: 20px;
                height: 20px;
                border: 2px solid rgba(233, 30, 99, 0.6);
                border-radius: 50%;
                transform: translate(-50%, -50%);
                pointer-events: none;
                z-index: 180;
                animation: rippleExpand 1s ease-out forwards;
            `;
            document.body.appendChild(ripple);
            setTimeout(() => ripple.remove(), 1000);
        }

        // æ·»åŠ æ¶Ÿæ¼ªåŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes rippleExpand {
                0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(4); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // é£˜è½èŠ±ç“£
        function createPetal() {
            const petal = document.createElement('div');
            petal.className = 'petal';
            const petals = ['ğŸŒ¸', 'ğŸŒº', 'ğŸŒ·', 'ğŸ’®', 'ğŸª·', 'âœ¿'];
            petal.textContent = petals[Math.floor(Math.random() * petals.length)];
            petal.style.left = Math.random() * window.innerWidth + 'px';
            petal.style.fontSize = (15 + Math.random() * 15) + 'px';
            petal.style.animationDuration = (6 + Math.random() * 6) + 's';
            petal.style.opacity = 0.6 + Math.random() * 0.4;
            document.body.appendChild(petal);
            setTimeout(() => petal.remove(), 12000);
        }

        // é—ªçƒæ˜Ÿæ˜Ÿ
        function createSparkle() {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.textContent = ['âœ¨', 'â­', 'ğŸ’«', 'ğŸŒŸ'][Math.floor(Math.random() * 4)];
            sparkle.style.left = Math.random() * window.innerWidth + 'px';
            sparkle.style.top = Math.random() * window.innerHeight + 'px';
            sparkle.style.fontSize = (10 + Math.random() * 12) + 'px';
            document.body.appendChild(sparkle);
            setTimeout(() => sparkle.remove(), 1500);
        }

        // æŒç»­ç”ŸæˆèŠ±ç“£å’Œæ˜Ÿæ˜Ÿ
        function startEffects() {
            // èŠ±ç“£
            setInterval(createPetal, 800);
            // æ˜Ÿæ˜Ÿ
            setInterval(createSparkle, 400);
        }

        document.addEventListener('click', e => popHearts(e.clientX, e.clientY));
        document.addEventListener('touchstart', e => popHearts(e.touches[0].clientX, e.touches[0].clientY));

        // å¯åŠ¨
        window.onload = async () => {
            // æœ€å°åŠ è½½æ—¶é—´ 2 ç§’ï¼Œç¡®ä¿ç”¨æˆ·ä½“éªŒ
            const minLoadTime = new Promise(resolve => setTimeout(resolve, 2000));
            
            // åŒæ—¶æ‰§è¡Œåˆå§‹åŒ–èŠ±å›­å’Œæœ€å°åŠ è½½æ—¶é—´
            await Promise.all([initGarden(), minLoadTime]);
            
            // éšè— loading å±å¹•
            document.getElementById('loadingScreen').classList.add('hidden');
            
            // å¯åŠ¨å…¶ä»–æ•ˆæœ
            startEffects();
            
            // å¼€å§‹æ‰“å­—æœºæ•ˆæœ
            setTimeout(type, 500);
        };

        // çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°åˆå§‹åŒ–
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                const garden = document.getElementById('garden');
                garden.innerHTML = '';
                initGarden();
            }, 300);
        });
    </script>
</body>
</html>
